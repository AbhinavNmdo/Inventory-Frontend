<h1 class="text-white text-4xl font-bold">Create Purchase</h1>

<app-alert></app-alert>
<form [formGroup]="purchaseStore" class="card" (ngSubmit)="purchaseStoreCall()">
  <div class="card-body mt-0">
    <div class="grid grid-cols-3 gap-5">
      <div>
        <label for="vendor" class="form-label">Vendor</label>
        <input type="text" class="form-input" formControlName="vendor">
      </div>
      <div>
        <label for="bill_no" class="form-label">Bill No</label>
        <input type="text" class="form-input" formControlName="billNo">
      </div>
    </div>
    <div class="flex justify-end mt-4">
      <button type="button" class="btn-success" (click)="addPurchase()">Add more</button>
    </div>
    <div class="mt-4 table-parent">
      <table class="table" formArrayName="purchases">
        <thead>
          <tr>
            <th>Category</th>
            <th>Sub-Category</th>
            <th>Product</th>
            <th>Quantity</th>
            <th>Amount</th>
            <th>-</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let purchase of purchaseControls; let i = index;" formGroupName="{{i}}">
            <td>
              <select class="form-select w-full">
                <option value="">Select</option>
              </select>
            </td>
            <td>
              <select class="form-select w-full">
                <option value="">Select</option>
              </select>
            </td>
            <td>
              <select formControlName="productId" class="form-select w-full">
                <option value="">Select</option>
              </select>
            </td>
            <td>
              <input type="number" class="form-input" formControlName="quantity">
            </td>
            <td>
              <input type="number" class="form-input" formControlName="amount">
            </td>
            <td>
              <i *ngIf="i > 0" (click)="removePurchase(i)" class="material-icons cursor-pointer text-red-500 select-none">delete</i>
              <span *ngIf="i == 0">-:-</span>
            </td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td class="text-right">Total Amount</td>
            <td>
              <input type="number" formControlName="totalAmt" class="form-input" readonly>
            </td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div class="card-footer">
    <button class="btn-primary">Submit</button>
  </div>
</form>
